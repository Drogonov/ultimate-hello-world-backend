## Description

CRUD and Auth app for my [ultimate-hello-world-ios](https://github.com/Drogonov/ultimate-hello-world-ios).

## How to setup?

Create your own development.env and production.env files in the ./config directory. 

Use naming from example.env file.

```
npm install
```

### DEV & Docker

Create dev containers of the app and db
```
npm run docker:compose-dev
```

### DEV & command line

Create dev containers of the app and db
Then delete/shut down app from docker containers

```
npm run docker:compose-dev
```

Setup prisma and prisma studio
(Be carefull because when you dont use container you need to change db-host to localhost in all prisma links. It is not best solvation but it works for me)

```
npm run prisma:generate-dev-local
```
```
npm run prisma:db-push-dev-local
```
```
npm run prisma:studio-dev
```

Start the App

```
npm run start:dev
```

### PROD

#### 1. Github Setup

Add all credentials to your github
Settings/Secrets and variables/Actions

You will need

- ENV_FILE_PATH - path to your .env files
- REPO_PATH - path to the repo on the VPS server with you project
- SSH_KEY - need to connect to the server
- VPS_HOST - server ip
- VPS_USER - server user

#### 1.1 SSH Generation

SSH key is generated by following commands (remember Github need key without pass phrase)

Create SSH key
```
ssh-keygen -t ed25519 -C "you@example.com" -f ~/.ssh/my_custom_name
```

Send key to the VPS
```
ssh-copy-id -i ~/.ssh/my_custom_name.pub my_username@vps_ip_address
```

Copy your SSH key and save it in the GitHub
```
cat ~/.ssh/my_custom_name.pub
```

#### 2. VPS setup

- Connect via SSH to the server
- Create directory for your projects 
- git clone your repo
- Copy all credentials from your local machine 
- go to the ./config directory

```
nano production.env
```
- Paste credentials and save them

#### 3. Profit

Now when all jobs will be finished on your github Action will go to the server update repo and run docker compose

## License

[ultimate-hello-world-backend](https://github.com/Drogonov/ultimate-hello-world-backend) is created by [Anton Vlezko](https://github.com/Drogonov) and released under a [MIT License](LICENSE).
